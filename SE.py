import realisticPotentialModel as pm
import utilities as uT
import matplotlib.pyplot as plt
import atom as at
import numpy as np


UClassical = [-477.4257679074742, -724.7932554291327, -885.0179188270347, -987.2639238622828, -1051.198067536929, -1090.0951707725276, -1112.854236760067, -1125.3496866622538, -1131.3621898278348, -1133.2333297180228, -1132.3318643283576, -1129.3870967290625, -1124.7260901071, -1118.4401822223417, -1110.499181104442, -1100.8269415545353, -1089.3487360973672, -1076.0184026933082, -1060.8313795538734, -1043.828261385525, -1025.0923366414463, -1004.7436321336463, -982.9312572983035, -959.8252719925576, -935.608870367761, -910.4713539883594, -884.6021377900241, -858.1858734161628, -831.3986695083096, -804.40532398114, -777.3574480886448, -750.3923474003299, -723.6325238791314, -697.1856709984565, -671.1450465433459, -645.5901227925206, -620.587429400183, -596.1915193499871, -572.4460021634573, -549.3846007651284, -527.0321989146028, -505.4058549357039, -484.5157647177288, -464.3661627942543, -444.9561549024289, -426.2804789733222, -408.3301941756973, -391.0932995896714, -374.555285462798, -358.6996209191096]

zClassical = [2.4,        2.47346939, 2.54693878, 2.62040816, 2.69387755, 2.76734694,
              2.84081633, 2.91428571, 2.9877551,  3.06122449, 3.13469388, 3.20816327,
              3.28163265, 3.35510204, 3.42857143, 3.50204082, 3.5755102,  3.64897959,
              3.72244898, 3.79591837, 3.86938776, 3.94285714, 4.01632653, 4.08979592,
              4.16326531, 4.23673469, 4.31020408, 4.38367347, 4.45714286, 4.53061224,
              4.60408163, 4.67755102, 4.75102041, 4.8244898,  4.89795918, 4.97142857,
              5.04489796, 5.11836735, 5.19183673, 5.26530612, 5.33877551, 5.4122449,
              5.48571429, 5.55918367, 5.63265306, 5.70612245, 5.77959184, 5.85306122,
              5.92653061, 6.        ]

UYClassical = [798077.1406425702, 971383.3808387117, 1074870.174768974, 1076664.1017769475, 977131.6997968603, 808348.1859949518, 615861.3910234234, 437781.6877308799, 294441.81497164577, 189895.45290286493, 118796.62683908855, 72731.47295064435, 43830.485654258126, 26058.57977697525, 15253.421324046098, 8717.964545658808, 4768.879443075801, 2378.546397474473, 927.4484724797506, 44.52897462205567, -491.8139716590973, -813.7953485583638, -1000.2180483297578, -1097.7909855361656, -1133.526953749301, -1121.569313482781, -1066.2691116133199, -962.30403324091, -791.82430008294, -517.8033150310462, -71.73774726150828, 667.6900128811412, 1910.7663107469132, 4017.2012152298666, 7595.777765197878, 13664.94144722812, 23901.69156332598, 41001.208695946036, 69130.32754714148, 114337.01394321196, 184513.84657252353, 288109.0712259206, 430514.1261821174, 607729.6275821936, 799481.2282320973, 967713.8980357267, 1066923.5053603668, 1065058.7745966301, 961752.2156887492, 788851.2853092585]

UXClassical = [2626.571742181975, 3757.8136020952734, 4992.906305669698, 6232.554760019322, 7348.212434534858, 8202.791692311748, 8679.625021991458, 8710.982370820078, 8295.670343353799, 7498.653479036956, 6432.95777771129, 5231.277950853891, 4017.7601109842494, 2888.3228886631514, 1902.751498038673, 1086.9035633509689, 440.7992304768495, -51.68936646227485, -414.4285366616614, -673.1002172267135, -851.7490657385428, -971.1770838141342, -1048.4234806720108, -1096.6542843691684, -1124.9042781728167, -1137.1396831542897, -1129.9627902882885, -1087.8660964294368, -974.080528533293, -713.3506573000716, -159.53986190907926, 966.076750434074, 3194.8280920794905, 7550.05181388993, 16037.696873767009, 32678.16815313978, 65725.7461472417, 132519.69161129108, 270155.6331943379, 558779.4539582212, 1170978.9902040397, 2470039.9469011636, 5181731.01744556, 10618385.94287429, 20747482.2289405, 37513459.74532606, 60674006.2076023, 84869188.29206914, 99885505.53005826, 97476495.21453905]


yClassical = [-3.,         -2.87755102, -2.75510204, -2.63265306, -2.51020408, -2.3877551,
              -2.26530612, -2.14285714, -2.02040816, -1.89795918, -1.7755102,  -1.65306122,
              -1.53061224, -1.40816327, -1.28571429, -1.16326531, -1.04081633, -0.91836735,
              -0.79591837, -0.67346939, -0.55102041, -0.42857143, -0.30612245, -0.18367347,
              -0.06122449,  0.06122449,  0.18367347,  0.30612245,  0.42857143,  0.55102041,
              0.67346939,  0.79591837,  0.91836735,  1.04081633,  1.16326531,  1.28571429,
              1.40816327,  1.53061224,  1.65306122,  1.7755102 ,  1.89795918,  2.02040816,
              2.14285714,  2.26530612,  2.3877551,   2.51020408,  2.63265306,  2.75510204,
              2.87755102,  3.        ]


CuDist = [1.37, 1.441395348837209, 1.512790697674419, 1.584186046511628, 1.655581395348837, 1.726976744186047, 1.798372093023256, 1.869767441860465, 1.941162790697675, 2.012558139534884, 2.083953488372093, 2.155348837209303, 2.226744186046512, 2.298139534883721, 2.36953488372093, 2.44093023255814, 2.512325581395349, 2.583720930232558, 2.655116279069768, 2.726511627906977, 2.797906976744186, 2.869302325581396, 2.940697674418605, 3.012093023255814, 3.083488372093024, 3.154883720930233, 3.226279069767442, 3.297674418604652, 3.369069767441861, 3.44046511627907, 3.51186046511628, 3.583255813953489, 3.654651162790698, 3.726046511627907, 3.797441860465117, 3.868837209302326, 3.940232558139535, 4.011627906976745, 4.083023255813954, 4.154418604651164, 4.225813953488373, 4.297209302325582, 4.368604651162791, 4.44]

CuPot = [2102.614491540029, 46.514434213940326, -1540.284559954632, -2424.7045862659443, -2661.3652615688497, -2466.5728487913316, -2071.0784090745487, -1645.7705605991628, -1296.3373828843253, -1076.9618613216148, -1001.1884004801402, -1048.3860241557597, -1164.5813294410527, -1288.1750626466874, -1380.37890139666, -1428.316595167823, -1436.1371193962136, -1414.956417450356, -1375.118392289081, -1323.968146167444, -1265.092714178772, -1198.6860116064095, -1123.4062111270237, -1037.923831969054, -942.6153670383138, -840.3447690691073, -735.6874907494524, -633.8528603297327, -539.1191721776377, -454.26500890520816, -380.4902204206937, -317.60475789231356, -264.60769347464105, -220.12484649107637, -182.74473017987407, -151.30797497453057, -124.85298394009226, -102.55796257438773, -83.68421791713826, -67.51237992583448, -53.40769930973494, -40.87442314109716, -29.491902253569762, -18.739316497559948]

CuDist1 = [1.37, 1.472333333333333, 1.574666666666667, 1.677, 1.779333333333333, 1.881666666666667, 1.984, 2.086333333333334, 2.188666666666667, 2.291, 2.393333333333334, 2.495666666666667, 2.598, 2.700333333333334, 2.802666666666667, 2.905, 3.007333333333333, 3.109666666666667, 3.212000000000001, 3.314333333333334, 3.416666666666667, 3.519000000000001, 3.621333333333334, 3.723666666666667, 3.826000000000001, 3.928333333333334, 4.030666666666667, 4.133000000000001, 4.235333333333333, 4.337666666666667, 4.44]

CuPot1 = [2102.614491540029, -718.5597518021877, -2348.0343460105796, -2636.961006074128, -2184.9710535918844, -1580.2621260381488, -1147.4020283909078, -1000.998928987634, -1097.9659571592995, -1276.7676449815433, -1401.2299025428301, -1437.3428424247388, -1408.1827094626774, -1343.754407260896, -1260.9085676829227, -1162.272427242143, -1043.940252847615, -905.7103558034831, -756.5524131158113, -610.9729477746979, -481.346078909548, -373.7208202382818, -288.1929750776306, -221.48586729932595, -169.51611096842447, -128.9524038353327, -97.22033621621759, -72.1220991221831, -51.655605431714804, -34.31101264003258, -18.739316497559948]

CuPot01 = [2102.614491540029, 1801.4857156585228, 1501.8342729817946, 1205.1374967146282, 912.8727200617883, 626.5172762280597, 347.5484975793408, 77.32462892377313, -183.2453206323091, -433.3582539656671, -672.211073953068, -899.0006834712741, -1112.923985397062, -1313.1778928733402, -1499.1123963509476, -1670.616882125646, -1827.6994825947677, -1970.3683301556387, -2098.6315572055846, -2212.497318700612, -2312.0876270918716, -2397.903027395765, -2470.5226298503994, -2530.5255446938813, -2578.4908821643166, -2614.9977524998135, -2640.6252787336443, -2655.9794145337464, -2661.7495014988117, -2658.641033917319, -2647.359506077744, -2628.6104122685665, -2603.099246778263, -2571.531474922159, -2534.5809902100195, -2492.8299062739716, -2446.8437521221335, -2397.188056762626, -2344.428349203563, -2289.1301584530634, -2231.85892958261, -2173.125646001183, -2113.293113346886, -2052.6991737630633, -1991.6816693930562, -1930.5784423802081, -1869.7273348678636, -1809.4661889993636, -1750.1327477412808, -1692.0250298078843, -1635.3407708921613, -1580.2621260381488, -1526.971250289888, -1475.6502986914134, -1426.4814262867644, -1379.6466755283209, -1335.296436365149, -1293.5062080556747, -1254.3406600749363, -1217.8644618979683, -1184.1422829998126, -1153.2387928555042, -1125.21853510198, -1100.1200280151654, -1077.9240409768126, -1058.6035784780508, -1042.1316450100069, -1028.4812450638083, -1017.6253831305826, -1009.5369028425017, -1004.1632620263696, -1001.3990575729658, -1001.1322850825841, -1003.2509401555185, -1007.6428544691389, -1014.1741426379488, -1022.667689127199, -1032.9412614389332, -1044.8126270751948, -1058.0995535380275, -1072.6198173146547, -1088.1921761126757, -1104.6372388145244, -1121.7758195768586, -1139.428732556336, -1157.416791909614, -1175.5608117933511, -1193.6819672854172, -1211.6335128126846, -1229.325579112716, -1246.674133022639, -1263.5951413795826, -1280.004571020676, -1295.8183887830478, -1310.9525615038285, -1325.3230560201455, -1338.846295606151, -1351.4706439967945, -1363.1967856943036, -1374.0302515481706, -1383.9765724078868, -1393.041279122942, -1401.2299025428301, -1408.5479735170422, -1415.0010228950698, -1420.5945815264035, -1425.3343778658334, -1429.237037703096, -1432.3355482119111, -1434.664243881044, -1436.2574591992602, -1437.1495286553234, -1437.3747867379986, -1436.9675679360512, -1435.9622067382452, -1434.393037633345, -1432.2943225242109, -1429.6970940077351, -1426.6279374163746, -1423.1131140576545, -1419.1788852391003, -1414.8515122682365, -1410.1572564525898, -1405.1223790996848, -1399.7731415170472, -1394.135805012201, -1388.2364565440305, -1382.0948047461895, -1375.7224965521928, -1369.1306620715673, -1362.3304314138418, -1355.3329346885434, -1348.149302005201, -1340.790663473339, -1333.2681492024885, -1325.5928893021758, -1317.775825610273, -1309.8221460724128, -1301.730361290979, -1293.4986076228865, -1285.1250214250479, -1276.607739054382, -1267.9448968678, -1259.1346312222179, -1250.1750784745525, -1241.0643749817164, -1231.8005949868016, -1222.3802058448077, -1212.7979622626112, -1203.048535654312, -1193.1265974340129, -1183.0268190158172, -1172.7438718138262, -1162.272427242143, -1151.6071567148695, -1140.7427316461076, -1129.6739613365644, -1118.3987084242085, -1106.917824703744, -1095.232287018559, -1083.3430722120418, -1071.2511571275797, -1058.957518608561, -1046.4631334983742, -1033.768978640407, -1020.8760308780481, -1007.7855353503812, -994.5038708867853, -981.0420324464686, -967.4111794056615, -953.6224711405952, -939.6870670275005, -925.6161264426082, -911.4208087621495, -897.1122733623549, -882.7016796194556, -868.2003136080725, -853.6215732413565, -838.98060024085, -824.2925885733633, -809.5727322057091, -794.8362251046995, -780.0982612371464, -765.3740345698609, -750.6787390696553, -736.0275687033416, -721.4355730602324, -706.9156907928844, -692.4792604404932, -678.1375807941171, -663.9019506448136, -649.7836687836409, -635.7940340016569, -621.9443450899192, -608.2459008394861, -594.7100000414159, -581.3476510038456, -568.1661142509233, -555.1700437425473, -542.3640406766068, -529.7527062509895, -517.3406416635868, -505.13244811228594, -493.13272679497663, -481.346078909548, -469.77710565388924, -458.430130810452, -447.3063035117481, -436.40474836527136, -425.7245572826308, -415.2648221754362, -405.0246349552961, -395.0030875338202, -385.19927182261773, -375.6122797332983, -366.2412031774709, -357.08497461986695, -348.14090092043335, -339.405339150883, -330.8746344601086, -322.54513199700443, -314.4131769104643, -306.47511434938167, -298.72728946265045, -291.1660473991642, -283.7877333078167, -276.5886637149488, -269.56489417624766, -262.7123406818933, -256.02691790430106, -249.50454051588574, -243.14112318906228, -236.93258059624594, -230.87482740985143, -224.96377830229397, -219.19534794598857, -213.5655310534691, -208.07097710179227, -202.70865573752826, -197.47553878669666, -192.36859807531658, -187.3848054294076, -182.52113267498916, -177.77455163808068, -173.14203414470168, -168.6205520208713, -164.2071349743179, -159.8992387096429, -155.69450916820978, -151.59059317390427, -147.5851375506115, -143.6757891222171, -139.86019471260667, -136.13600114566538, -132.5008552452789, -128.9524038353327, -125.48832632012257, -122.10651832906038, -118.8049635628025, -115.58164597960611, -112.43454953772833, -109.36165819542641, -106.36095591095727, -103.43042664257828, -100.5680543485461, -97.77182298711874, -95.03971905556536, -92.36974427465275, -89.7599060133124, -87.20821164977528, -84.71266856227074, -82.27128412902903, -79.88206572828021, -77.5430207382543, -75.25215653718136, -73.0074805032914, -70.80707319972097, -68.64941221305355, -66.53310912903248, -64.45677563710049, -62.41902342670164, -60.41846418727847, -58.45370960827499, -56.5233713791338, -54.62606118929888, -52.760390728212855, -50.92501176744888, -49.118773036691856, -47.34058366300239, -45.58935278930855, -43.86398955853838, -42.163403113619914, -40.48650259748121, -38.83219715305032, -37.19939592325528, -35.58700805102429, -33.99384290322141, -32.41826541584544, -30.85851682746181, -29.312838371516346, -27.77947128145374, -26.25665679071982, -24.742636132759298, -23.235650541017993, -21.73394124894075, -20.235749489972974, -18.739316497559948]

CuDist01 = [1.37, 1.380032679738562, 1.390065359477124, 1.400098039215686, 1.410130718954248, 1.420163398692811, 1.430196078431373, 1.440228758169935, 1.450261437908497, 1.460294117647059, 1.470326797385621, 1.480359477124183, 1.490392156862745, 1.500424836601307, 1.510457516339869, 1.520490196078431, 1.530522875816994, 1.540555555555556, 1.550588235294118, 1.56062091503268, 1.570653594771242, 1.580686274509804, 1.590718954248366, 1.600751633986928, 1.61078431372549, 1.620816993464052, 1.630849673202615, 1.640882352941177, 1.650915032679739, 1.660947712418301, 1.670980392156863, 1.681013071895425, 1.691045751633987, 1.701078431372549, 1.711111111111111, 1.721143790849673, 1.731176470588236, 1.741209150326797, 1.75124183006536, 1.761274509803922, 1.771307189542484, 1.781339869281046, 1.791372549019608, 1.80140522875817, 1.811437908496732, 1.821470588235294, 1.831503267973856, 1.841535947712418, 1.851568627450981, 1.861601307189543, 1.871633986928105, 1.881666666666667, 1.891699346405229, 1.901732026143791, 1.911764705882353, 1.921797385620915, 1.931830065359477, 1.941862745098039, 1.951895424836601, 1.961928104575164, 1.971960784313726, 1.981993464052288, 1.99202614379085, 2.002058823529412, 2.012091503267974, 2.022124183006536, 2.032156862745098, 2.04218954248366, 2.052222222222222, 2.062254901960785, 2.072287581699347, 2.082320261437909, 2.092352941176471, 2.102385620915033, 2.112418300653595, 2.122450980392157, 2.132483660130719, 2.142516339869281, 2.152549019607843, 2.162581699346406, 2.172614379084967, 2.182647058823529, 2.192679738562092, 2.202712418300654, 2.212745098039216, 2.222777777777778, 2.23281045751634, 2.242843137254902, 2.252875816993464, 2.262908496732027, 2.272941176470589, 2.28297385620915, 2.293006535947713, 2.303039215686275, 2.313071895424837, 2.323104575163399, 2.333137254901961, 2.343169934640523, 2.353202614379085, 2.363235294117647, 2.373267973856209, 2.383300653594771, 2.393333333333334, 2.403366013071896, 2.413398692810458, 2.42343137254902, 2.433464052287582, 2.443496732026144, 2.453529411764706, 2.463562091503268, 2.47359477124183, 2.483627450980392, 2.493660130718955, 2.503692810457517, 2.513725490196078, 2.523758169934641, 2.533790849673203, 2.543823529411765, 2.553856209150327, 2.563888888888889, 2.573921568627451, 2.583954248366013, 2.593986928104576, 2.604019607843138, 2.6140522875817, 2.624084967320262, 2.634117647058824, 2.644150326797386, 2.654183006535948, 2.66421568627451, 2.674248366013072, 2.684281045751634, 2.694313725490196, 2.704346405228758, 2.71437908496732, 2.724411764705883, 2.734444444444445, 2.744477124183007, 2.754509803921569, 2.764542483660131, 2.774575163398693, 2.784607843137255, 2.794640522875818, 2.804673202614379, 2.814705882352941, 2.824738562091504, 2.834771241830066, 2.844803921568628, 2.85483660130719, 2.864869281045752, 2.874901960784314, 2.884934640522876, 2.894967320261438, 2.905, 2.915032679738562, 2.925065359477125, 2.935098039215687, 2.945130718954249, 2.955163398692811, 2.965196078431373, 2.975228758169935, 2.985261437908497, 2.995294117647059, 3.005326797385621, 3.015359477124183, 3.025392156862745, 3.035424836601307, 3.045457516339869, 3.055490196078432, 3.065522875816994, 3.075555555555556, 3.085588235294118, 3.09562091503268, 3.105653594771242, 3.115686274509804, 3.125718954248367, 3.135751633986929, 3.145784313725491, 3.155816993464053, 3.165849673202615, 3.175882352941177, 3.185915032679739, 3.195947712418301, 3.205980392156863, 3.216013071895425, 3.226045751633987, 3.236078431372549, 3.246111111111111, 3.256143790849674, 3.266176470588236, 3.276209150326798, 3.28624183006536, 3.296274509803922, 3.306307189542484, 3.316339869281046, 3.326372549019608, 3.33640522875817, 3.346437908496732, 3.356470588235295, 3.366503267973856, 3.376535947712419, 3.386568627450981, 3.396601307189543, 3.406633986928105, 3.416666666666667, 3.426699346405229, 3.436732026143791, 3.446764705882353, 3.456797385620916, 3.466830065359478, 3.476862745098039, 3.486895424836602, 3.496928104575164, 3.506960784313726, 3.516993464052288, 3.52702614379085, 3.537058823529412, 3.547091503267974, 3.557124183006536, 3.567156862745098, 3.57718954248366, 3.587222222222223, 3.597254901960785, 3.607287581699347, 3.617320261437909, 3.627352941176471, 3.637385620915033, 3.647418300653595, 3.657450980392157, 3.667483660130719, 3.677516339869281, 3.687549019607844, 3.697581699346406, 3.707614379084968, 3.71764705882353, 3.727679738562092, 3.737712418300654, 3.747745098039216, 3.757777777777778, 3.76781045751634, 3.777843137254902, 3.787875816993465, 3.797908496732027, 3.807941176470589, 3.817973856209151, 3.828006535947713, 3.838039215686275, 3.848071895424837, 3.858104575163399, 3.868137254901961, 3.878169934640523, 3.888202614379086, 3.898235294117647, 3.908267973856209, 3.918300653594772, 3.928333333333334, 3.938366013071896, 3.948398692810458, 3.95843137254902, 3.968464052287582, 3.978496732026144, 3.988529411764706, 3.998562091503268, 4.00859477124183, 4.018627450980393, 4.028660130718954, 4.038692810457517, 4.048725490196079, 4.058758169934642, 4.068790849673203, 4.078823529411765, 4.088856209150327, 4.098888888888889, 4.108921568627451, 4.118954248366014, 4.128986928104576, 4.139019607843138, 4.1490522875817, 4.159084967320261, 4.169117647058824, 4.179150326797386, 4.189183006535949, 4.19921568627451, 4.209248366013073, 4.219281045751634, 4.229313725490197, 4.239346405228758, 4.249379084967321, 4.259411764705883, 4.269444444444445, 4.279477124183007, 4.289509803921569, 4.299542483660131, 4.309575163398693, 4.319607843137256, 4.329640522875817, 4.33967320261438, 4.349705882352941, 4.359738562091504, 4.369771241830065, 4.379803921568628, 4.38983660130719, 4.399869281045753, 4.409901960784314, 4.419934640522876, 4.429967320261438, 4.44]


def SE(potential, psi1, psi2, coordArray, mass):
    E = -2184.53978751
    psi = []
    psi.append(psi1)
    psi.append(psi2)
    for i in range(1, len(coordArray)-1):
        deltaCoordSquared = (coordArray[i]-coordArray[i-1])**2
        convertedCoeff = 2*mass/(uT.hbar**2)*uT.kB*(1/10**20)
        psiNext = (convertedCoeff*deltaCoordSquared*(potential[i]-E)+2)*psi[i]-psi[i-1]
        #print(((2*mass/uT.hbar)*(potential[coordArray[i]]-E)*deltaCoordSquared+2)*phi[i]-phi[i-1])
        psi.append(psiNext)
    #print(psi)
    return psi

def psi(coordArray):
    return SE(CuPot01, 0, 0.001, coordArray, at.deuterium.mass)


def makeFile(fileName, psiLst):
    np.savetxt(fileName, psiLst, delimiter=", ")


makeFile("psi01groundstate.txt", psi(CuDist01))

#print(len(psi(CuDist)))
#plt.plot(CuDist01, psi(CuDist01))
#plt.show()
